<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="AlumniRegister">


	<select id="getAlumniCount" resultType="java.lang.Integer">
		SELECT count(id)+1 as
		count from alumni.students;
	</select>

	<insert id="InsertAlumniStudent" parameterType="map">
		INSERT INTO
		alumni.students(username, first_name, last_name,
		password,email,mobile_no,status,college_code,user_id,
		qualification,branch,passed_out_year,district,other_qualifiction,roll_number,role_id,token,mail_verify)
		VALUES
		(#{p.username},#{p.first_name},#{p.last_name},md5(#{p.password}),#{p.email},#{p.mobile_no},0,#{p.college_code},
		('AS' || '' ||lpad(CAST( #{id} AS character varying
		),4,'0')),#{p.qualification},#{p.branch},#{p.passed_out_year},
		#{p.district},#{p.other_qualifiction},#{p.roll_number},6,#{p.token},false);
	</insert>

	<insert id="InsertAlumniEmployee" parameterType="map">
		INSERT INTO
		alumni.students(username, first_name, last_name,
		password,email,mobile_no,status,organization_name,user_id,employee_id,role_id,token,mail_verify)
		VALUES
		(#{p.username},#{p.first_name},#{p.last_name},md5(#{p.password}),#{p.email},#{p.mobile_no},0,
		#{p.organization_name},('AE' || '' ||lpad(CAST( #{id} AS character
		varying ),4,'0')),#{p.employee_id},5,#{p.token},false);
	</insert>

	<insert id="InsertAlumniUserEmployee" parameterType="map">
		INSERT INTO
		alumni.users(username, password, role_id, status, user_id)
		VALUES
		(#{p.username}, md5(#{p.password}),5, true,('AE' || '' ||lpad(CAST(
		#{id} AS character varying ),4,'0')));
	</insert>

	<insert id="InsertAlumniUserStudent" parameterType="map">
		INSERT INTO
		alumni.users(username, password, role_id, status, user_id)
		VALUES
		(#{p.username}, md5(#{p.password}),6, true,('AS' || '' ||lpad(CAST(
		#{id} AS character varying ),4,'0')));
	</insert>

	<select id="getAllAlumnisData" resultType="AlumniRegister">
		SELECT id,username,
		first_name, last_name, password,email,mobile_no, photo,status from
		alumni.students order by id;
	</select>


	<!-- ....................................... role assaign ............................... -->
	<insert id="InsertAlumniAdmin" parameterType="map">
		INSERT INTO
		alumni.students(username, first_name, last_name,
		password,email,mobile_no,status,user_id)
		VALUES
		(#{p.username},#{p.first_name},#{p.last_name},md5(#{p.password}),#{p.email},#{p.mobile_no},2,
		('AD' || '' ||lpad(CAST( #{id} AS character varying ),4,'0')));
	</insert>

	<insert id="InsertAlumniUserAdmin" parameterType="map">
		INSERT INTO
		alumni.users(username, password, role_id, status, user_id)
		VALUES
		(#{p.username}, md5(#{p.password}),1, true,('AD' || '' ||lpad(CAST(
		#{id} AS character varying ),4,'0')));
	</insert>

	<insert id="InsertAlumniMdCEO" parameterType="map">
		INSERT INTO
		alumni.students(username, first_name, last_name,
		password,email,mobile_no,status,user_id)
		VALUES
		(#{p.username},#{p.first_name},#{p.last_name},md5(#{p.password}),#{p.email},#{p.mobile_no},2,
		('MDCEO' || '' ||lpad(CAST( #{id} AS character varying ),4,'0')));
	</insert>

	<insert id="InsertAlumniUserMdCEO" parameterType="map">
		INSERT INTO
		alumni.users(username, password, role_id, status, user_id)
		VALUES
		(#{p.username}, md5(#{p.password}),2, true,('MDCEO' || '' ||lpad(CAST(
		#{id} AS character varying ),4,'0')));
	</insert>

	<insert id="InsertAlumniED" parameterType="map">
		INSERT INTO
		alumni.students(username, first_name, last_name,
		password,email,mobile_no,status,user_id)
		VALUES
		(#{p.username},#{p.first_name},#{p.last_name},md5(#{p.password}),#{p.email},#{p.mobile_no},2,
		('ED' || '' ||lpad(CAST( #{id} AS character varying ),4,'0')));
	</insert>

	<insert id="InsertAlumniUserED" parameterType="map">
		INSERT INTO
		alumni.users(username, password, role_id, status, user_id)
		VALUES
		(#{p.username}, md5(#{p.password}),3, true,('ED' || '' ||lpad(CAST(
		#{id} AS character varying ),4,'0')));
	</insert>

	<insert id="InsertAlumniCGM" parameterType="map">
		INSERT INTO
		alumni.students(username, first_name, last_name,
		password,email,mobile_no,status,user_id)
		VALUES
		(#{p.username},#{p.first_name},#{p.last_name},md5(#{p.password}),#{p.email},#{p.mobile_no},2,
		('CGM' || '' ||lpad(CAST( #{id} AS character varying ),4,'0')));
	</insert>

	<insert id="InsertAlumniUserCGM" parameterType="map">
		INSERT INTO
		alumni.users(username, password, role_id, status, user_id)
		VALUES
		(#{p.username}, md5(#{p.password}),4, true,('CGM' || '' ||lpad(CAST(
		#{id} AS character varying ),4,'0')));
	</insert>


	<!-- Verify User -->

	<update id="verifyToken" parameterType="java.lang.Integer">
		update alumni.students
		set mail_verify = true, status = 1 where token=#{token} and mail_verify = false;
	</update>


</mapper>